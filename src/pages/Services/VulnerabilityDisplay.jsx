/**
 * ðŸ‡¬ðŸ‡¦ RSU Gabon - Vulnerability Display Component
 * Standards Top 1% - Affichage Score VulnÃ©rabilitÃ©
 * Fichier: rsu_admin_dashboard_v1/src/pages/Services/VulnerabilityDisplay.jsx
 * 
 * STRUCTURE BACKEND (apps/services_app/models.py VulnerabilityAssessment):
 * {
 *   overall_score: 75.50,
 *   risk_level: "HIGH",
 *   vulnerability_dimensions: {...},
 *   identified_needs: [...],
 *   recommended_interventions: [...],
 *   priority_interventions: [...],
 *   assessment_date: "2025-12-22T10:00:00Z"
 * }
 */

import React from 'react';

export default function VulnerabilityDisplay({ assessment }) {
  if (!assessment) return null;

  // Helper: Risk color
  const getRiskColor = (level) => {
    const colors = {
      'EXTREME': '#dc2626',  // Rouge foncÃ©
      'HIGH': '#ef4444',      // Rouge
      'MEDIUM': '#f59e0b',    // Orange
      'LOW': '#10b981'        // Vert
    };
    return colors[level] || '#6b7280';
  };

  // Helper: Risk label
  const getRiskLabel = (level) => {
    const labels = {
      'EXTREME': 'ExtrÃªme',
      'HIGH': 'Ã‰levÃ©',
      'MEDIUM': 'Moyen',
      'LOW': 'Faible'
    };
    return labels[level] || level;
  };

  const riskColor = getRiskColor(assessment.risk_level);

  return (
    <div className="vulnerability-display">
      {/* Score Principal */}
      <div className="vulnerability-header">
        <div className="score-circle" style={{ borderColor: riskColor }}>
          <div className="score-value" style={{ color: riskColor }}>
            {assessment.overall_score?.toFixed(1) || '0.0'}
          </div>
          <div className="score-max">/100</div>
        </div>

        <div className="risk-info">
          <h4>Niveau de Risque</h4>
          <span 
            className="risk-badge"
            style={{ backgroundColor: riskColor }}
          >
            {getRiskLabel(assessment.risk_level)}
          </span>
        </div>
      </div>

      {/* Dimensions de VulnÃ©rabilitÃ© */}
      {assessment.vulnerability_dimensions && (
        <div className="dimensions-section">
          <h5>Dimensions de VulnÃ©rabilitÃ©</h5>
          <div className="dimensions-grid">
            {Object.entries(assessment.vulnerability_dimensions).map(([key, value]) => (
              <div key={key} className="dimension-item">
                <span className="dimension-label">{key}</span>
                <div className="dimension-bar">
                  <div 
                    className="dimension-fill"
                    style={{ 
                      width: `${value}%`,
                      backgroundColor: value > 70 ? '#ef4444' : value > 40 ? '#f59e0b' : '#10b981'
                    }}
                  ></div>
                </div>
                <span className="dimension-value">{value?.toFixed(1)}%</span>
              </div>
            ))}
          </div>
        </div>
      )}

      {/* Besoins IdentifiÃ©s */}
      {assessment.identified_needs && assessment.identified_needs.length > 0 && (
        <div className="needs-section">
          <h5>ðŸŽ¯ Besoins IdentifiÃ©s</h5>
          <ul>
            {assessment.identified_needs.map((need, i) => (
              <li key={i}>{need}</li>
            ))}
          </ul>
        </div>
      )}

      {/* Interventions Prioritaires */}
      {assessment.priority_interventions && assessment.priority_interventions.length > 0 && (
        <div className="interventions-section priority">
          <h5>ðŸš¨ Interventions Prioritaires</h5>
          <ul>
            {assessment.priority_interventions.map((intervention, i) => (
              <li key={i}>{intervention}</li>
            ))}
          </ul>
        </div>
      )}

      {/* Recommandations */}
      {assessment.recommended_interventions && assessment.recommended_interventions.length > 0 && (
        <div className="interventions-section">
          <h5>ðŸ’¡ Recommandations</h5>
          <ul>
            {assessment.recommended_interventions.map((intervention, i) => (
              <li key={i}>{intervention}</li>
            ))}
          </ul>
        </div>
      )}

      {/* MÃ©tadonnÃ©es */}
      <div className="assessment-meta">
        {assessment.assessment_date && (
          <small>
            Ã‰valuation: {new Date(assessment.assessment_date).toLocaleDateString('fr-GA')}
          </small>
        )}
      </div>
    </div>
  );
}